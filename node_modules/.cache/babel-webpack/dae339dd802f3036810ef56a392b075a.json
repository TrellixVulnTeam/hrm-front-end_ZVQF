{"ast":null,"code":"import _asyncToGenerator from \"E:/front-end/hrm-front-end/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { environment } from '../../../../environments/environment.prod';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"../../notification/notification.service\";\nexport class DepartmentPageService {\n  constructor(httpClient, notificationService) {\n    this.httpClient = httpClient;\n    this.notificationService = notificationService;\n    this.isEditDepartment = false;\n    this.inputSearch = \"\";\n    this.sortString = \"ASC\";\n    this.mainAttribute = \"Name\";\n    this.mainAttributes = [\"Name\"];\n    this.locations = [\"HOCHIMINH\", \"DANANG\", \"CANTHO\"];\n    this.isLoadData = false;\n    this.isOutOfData = false;\n    this.departments = [];\n    this.editName = \"\";\n    this.editLocation = \"\";\n    this.editId = 0;\n    this.idDepartmentNeedRemove = 0;\n    this.isShowPopupRequest = false;\n    this.isShowNotification = false;\n    this.isProcessRemove = false;\n  }\n\n  loadData(event) {\n    this.isOutOfData = false;\n    this.departments = [];\n    this.getListDepartment(0, 25, this.inputSearch, this.mainAttribute == \"Name\" ? \"name\" : \"location\", this.sortString == \"ASC\" ? \"asc\" : \"desc\", event);\n  }\n\n  getListDepartment(min, max, search, mainAttribute, sort, event) {\n    var _this = this;\n\n    this.isLoadData = true;\n    document.getElementById(\"content-list\").scrollTop = 99999999;\n    setTimeout(() => {\n      this.getListDepartmentFromAPI(min, max, search, mainAttribute, sort).subscribe( /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator(function* (data) {\n          if (event == 1) {\n            _this.departments = [];\n          }\n\n          for (let i = 0; i < data.data.length; i++) {\n            yield _this.getEmployeeByIdDepartment(data.data[i].id).subscribe(dataGetEmployee => {\n              let member = 0;\n\n              if (dataGetEmployee.message != 'Not Found Departmant') {\n                member = dataGetEmployee.data.length;\n              }\n\n              let department = {\n                id: data.data[i].id,\n                location: data.data[i].location,\n                member: member,\n                name: data.data[i].name\n              };\n\n              _this.departments.push(department);\n            });\n          }\n\n          if (data.data.length < max || data.data.length == 0) {\n            _this.isOutOfData = true;\n          }\n\n          _this.isLoadData = false;\n        });\n\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }());\n    }, 1000);\n  }\n\n  getListDepartmentFromAPI(min, max, search, mainAttribute, sort) {\n    const url = `${environment.REST_API}department/part?min=${min}&max=${max}&sort=${sort}&search=${search}&mainAttribute=${mainAttribute}`;\n    return this.httpClient.get(url);\n  }\n\n  getEmployeeByIdDepartment(id) {\n    const url = `${environment.REST_API}employee/department/${id}`;\n    return this.httpClient.get(url);\n  }\n\n  saveItem() {\n    if (this.editName.trim().length > 0) {\n      this.saveDepartment().subscribe(data => {\n        console.log(data);\n        this.isEditDepartment = false;\n        this.loadData(0);\n        this.isShowPopupRequest = false;\n        this.isShowNotification = true;\n        this.notificationService.titlePopUpNotificationDepartment = \"Success\";\n        this.notificationService.childPopUpNotificationDepartment = `You have successfully updated the department #${this.editId}`;\n      });\n    }\n  }\n\n  addNewDepartment(body) {\n    const url = `${environment.REST_API}department`;\n    return this.httpClient.post(url, body);\n  }\n\n  saveDepartment() {\n    const url = `${environment.REST_API}department`;\n    let body = {\n      id: this.editId,\n      name: this.editName,\n      location: this.editLocation\n    };\n    return this.httpClient.put(url, body);\n  }\n\n  deleteDepartmentById(id) {\n    const url = `${environment.REST_API}department/${id}`;\n    return this.httpClient.delete(url);\n  }\n\n}\n\nDepartmentPageService.ɵfac = function DepartmentPageService_Factory(t) {\n  return new (t || DepartmentPageService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.NotificationService));\n};\n\nDepartmentPageService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: DepartmentPageService,\n  factory: DepartmentPageService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"sources":["E:/front-end/hrm-front-end/src/app/service/main-page/department-page/department-page.service.ts"],"names":["environment","i0","i1","i2","DepartmentPageService","constructor","httpClient","notificationService","isEditDepartment","inputSearch","sortString","mainAttribute","mainAttributes","locations","isLoadData","isOutOfData","departments","editName","editLocation","editId","idDepartmentNeedRemove","isShowPopupRequest","isShowNotification","isProcessRemove","loadData","event","getListDepartment","min","max","search","sort","document","getElementById","scrollTop","setTimeout","getListDepartmentFromAPI","subscribe","data","i","length","getEmployeeByIdDepartment","id","dataGetEmployee","member","message","department","location","name","push","url","REST_API","get","saveItem","trim","saveDepartment","console","log","titlePopUpNotificationDepartment","childPopUpNotificationDepartment","addNewDepartment","body","post","put","deleteDepartmentById","delete","ɵfac","DepartmentPageService_Factory","t","ɵɵinject","HttpClient","NotificationService","ɵprov","ɵɵdefineInjectable","token","factory","providedIn"],"mappings":"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","sourcesContent":["import { environment } from '../../../../environments/environment.prod';\r\nimport * as i0 from \"@angular/core\";\r\nimport * as i1 from \"@angular/common/http\";\r\nimport * as i2 from \"../../notification/notification.service\";\r\nexport class DepartmentPageService {\r\n    constructor(httpClient, notificationService) {\r\n        this.httpClient = httpClient;\r\n        this.notificationService = notificationService;\r\n        this.isEditDepartment = false;\r\n        this.inputSearch = \"\";\r\n        this.sortString = \"ASC\";\r\n        this.mainAttribute = \"Name\";\r\n        this.mainAttributes = [\r\n            \"Name\",\r\n        ];\r\n        this.locations = [\r\n            \"HOCHIMINH\",\r\n            \"DANANG\",\r\n            \"CANTHO\",\r\n        ];\r\n        this.isLoadData = false;\r\n        this.isOutOfData = false;\r\n        this.departments = [];\r\n        this.editName = \"\";\r\n        this.editLocation = \"\";\r\n        this.editId = 0;\r\n        this.idDepartmentNeedRemove = 0;\r\n        this.isShowPopupRequest = false;\r\n        this.isShowNotification = false;\r\n        this.isProcessRemove = false;\r\n    }\r\n    loadData(event) {\r\n        this.isOutOfData = false;\r\n        this.departments = [];\r\n        this.getListDepartment(0, 25, this.inputSearch, this.mainAttribute == \"Name\" ? \"name\" : \"location\", this.sortString == \"ASC\" ? \"asc\" : \"desc\", event);\r\n    }\r\n    getListDepartment(min, max, search, mainAttribute, sort, event) {\r\n        this.isLoadData = true;\r\n        document.getElementById(\"content-list\").scrollTop = 99999999;\r\n        setTimeout(() => {\r\n            this.getListDepartmentFromAPI(min, max, search, mainAttribute, sort).subscribe(async (data) => {\r\n                if (event == 1) {\r\n                    this.departments = [];\r\n                }\r\n                for (let i = 0; i < data.data.length; i++) {\r\n                    await this.getEmployeeByIdDepartment(data.data[i].id).subscribe(dataGetEmployee => {\r\n                        let member = 0;\r\n                        if (dataGetEmployee.message != 'Not Found Departmant') {\r\n                            member = dataGetEmployee.data.length;\r\n                        }\r\n                        let department = {\r\n                            id: data.data[i].id,\r\n                            location: data.data[i].location,\r\n                            member: member,\r\n                            name: data.data[i].name,\r\n                        };\r\n                        this.departments.push(department);\r\n                    });\r\n                }\r\n                if (data.data.length < max || data.data.length == 0) {\r\n                    this.isOutOfData = true;\r\n                }\r\n                this.isLoadData = false;\r\n            });\r\n        }, 1000);\r\n    }\r\n    getListDepartmentFromAPI(min, max, search, mainAttribute, sort) {\r\n        const url = `${environment.REST_API}department/part?min=${min}&max=${max}&sort=${sort}&search=${search}&mainAttribute=${mainAttribute}`;\r\n        return this.httpClient.get(url);\r\n    }\r\n    getEmployeeByIdDepartment(id) {\r\n        const url = `${environment.REST_API}employee/department/${id}`;\r\n        return this.httpClient.get(url);\r\n    }\r\n    saveItem() {\r\n        if (this.editName.trim().length > 0) {\r\n            this.saveDepartment().subscribe(data => {\r\n                console.log(data);\r\n                this.isEditDepartment = false;\r\n                this.loadData(0);\r\n                this.isShowPopupRequest = false;\r\n                this.isShowNotification = true;\r\n                this.notificationService.titlePopUpNotificationDepartment = \"Success\";\r\n                this.notificationService.childPopUpNotificationDepartment = `You have successfully updated the department #${this.editId}`;\r\n            });\r\n        }\r\n    }\r\n    addNewDepartment(body) {\r\n        const url = `${environment.REST_API}department`;\r\n        return this.httpClient.post(url, body);\r\n    }\r\n    saveDepartment() {\r\n        const url = `${environment.REST_API}department`;\r\n        let body = {\r\n            id: this.editId,\r\n            name: this.editName,\r\n            location: this.editLocation\r\n        };\r\n        return this.httpClient.put(url, body);\r\n    }\r\n    deleteDepartmentById(id) {\r\n        const url = `${environment.REST_API}department/${id}`;\r\n        return this.httpClient.delete(url);\r\n    }\r\n}\r\nDepartmentPageService.ɵfac = function DepartmentPageService_Factory(t) { return new (t || DepartmentPageService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.NotificationService)); };\r\nDepartmentPageService.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: DepartmentPageService, factory: DepartmentPageService.ɵfac, providedIn: 'root' });\r\n"]},"metadata":{},"sourceType":"module"}