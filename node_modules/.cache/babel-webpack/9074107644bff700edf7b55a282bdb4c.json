{"ast":null,"code":"import _asyncToGenerator from \"E:/front-end/hrm-front-end/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { environment } from './../../../../environments/environment.prod';\nimport { Department } from 'src/app/model/department';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"./../../notification/notification.service\";\nexport class DepartmentPageService {\n  constructor(httpClient, notificationService) {\n    this.httpClient = httpClient;\n    this.notificationService = notificationService;\n    this.isEditDepartment = false;\n    this.inputSearch = \"\";\n    this.sortString = \"ASC\";\n    this.mainAttribute = \"Name\";\n    this.mainAttributes = [\"Name\"];\n    this.locations = [\"HOCHIMINH\", \"DANANG\", \"CANTHO\"];\n    this.isLoadData = false;\n    this.isOutOfData = false;\n    this.departments = [];\n    this.editName = \"\";\n    this.editLocation = \"\";\n    this.editId = 0;\n    this.idDepartmentNeedRemove = 0;\n    this.isShowPopupRequest = false;\n    this.isShowNotification = false;\n    this.isProcessRemove = false;\n  }\n\n  loadData(event) {\n    this.isOutOfData = false;\n    this.departments = [];\n    this.getListDepartment(0, 25, this.inputSearch, this.mainAttribute == \"Name\" ? \"name\" : \"location\", this.getSortString() == \"ASC\" ? \"asc\" : \"desc\", event);\n  }\n\n  getListDepartment(min, max, search, mainAttribute, sort, event) {\n    var _this = this;\n\n    this.isLoadData = true;\n    document.getElementById(\"content-list\").scrollTop = 99999999;\n    setTimeout(() => {\n      this.getListDepartmentFromAPI(min, max, search, mainAttribute, sort).subscribe( /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator(function* (data) {\n          if (event == 1) {\n            _this.departments = [];\n          }\n\n          for (let i = 0; i < data.data.length; i++) {\n            let department = new Department();\n            department.id = data.data[i].id;\n            yield _this.getEmployeeByIdDepartment(department.id).subscribe(dataGetEmployee => {\n              if (dataGetEmployee.message == 'Not Found Departmant') {\n                department.member = 0;\n              } else {\n                department.member = data.data.length;\n              }\n            });\n            department.location = data.data[i].location;\n            department.name = data.data[i].name;\n\n            _this.departments.push(department);\n          }\n\n          if (data.data.length < max || data.data.length == 0) {\n            _this.isOutOfData = true;\n          }\n\n          _this.isLoadData = false;\n        });\n\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }());\n    }, 1000);\n  }\n\n  getListDepartmentFromAPI(min, max, search, mainAttribute, sort) {\n    const url = `${environment.REST_API}department/part?min=${min}&max=${max}&sort=${sort}&search=${search}&mainAttribute=${mainAttribute}`;\n    return this.httpClient.get(url);\n  }\n\n  getEmployeeByIdDepartment(id) {\n    const url = `${environment.REST_API}employee/department/${id}`;\n    return this.httpClient.get(url);\n  }\n\n  saveItem() {\n    if (this.editName.trim().length > 0) {\n      this.saveDepartment().subscribe(data => {\n        console.log(data);\n        this.hiddenEditDepartment();\n        this.loadData(0);\n        this.isShowPopupRequest = false;\n        this.isShowNotification = true;\n        this.notificationService.titlePopUpNotificationDepartment = \"Success\";\n        this.notificationService.childPopUpNotificationDepartment = `You have successfully updated the department #${this.editId}`;\n      });\n    }\n  }\n\n  addNewDepartment(body) {\n    const url = `${environment.REST_API}department`;\n    return this.httpClient.post(url, body);\n  }\n\n  saveDepartment() {\n    const url = `${environment.REST_API}department`;\n    let body = {\n      id: this.editId,\n      name: this.editName,\n      location: this.editLocation\n    };\n    return this.httpClient.put(url, body);\n  }\n\n  deleteDepartmentById(id) {\n    const url = `${environment.REST_API}department/${id}`;\n    return this.httpClient.delete(url);\n  }\n\n  isShowEditDepartment() {\n    return this.isEditDepartment;\n  }\n\n  showEditDepartment() {\n    this.isEditDepartment = true;\n  }\n\n  hiddenEditDepartment() {\n    this.isEditDepartment = false;\n  }\n\n  getMainAttributes() {\n    return this.mainAttributes;\n  }\n\n  getSortString() {\n    return this.sortString;\n  }\n\n  changeSort(newSort) {\n    this.sortString = newSort;\n  }\n\n}\n\nDepartmentPageService.ɵfac = function DepartmentPageService_Factory(t) {\n  return new (t || DepartmentPageService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.NotificationService));\n};\n\nDepartmentPageService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: DepartmentPageService,\n  factory: DepartmentPageService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"sources":["E:/front-end/hrm-front-end/src/app/service/main-page/department-page/department-page.service.ts"],"names":["environment","Department","i0","i1","i2","DepartmentPageService","constructor","httpClient","notificationService","isEditDepartment","inputSearch","sortString","mainAttribute","mainAttributes","locations","isLoadData","isOutOfData","departments","editName","editLocation","editId","idDepartmentNeedRemove","isShowPopupRequest","isShowNotification","isProcessRemove","loadData","event","getListDepartment","getSortString","min","max","search","sort","document","getElementById","scrollTop","setTimeout","getListDepartmentFromAPI","subscribe","data","i","length","department","id","getEmployeeByIdDepartment","dataGetEmployee","message","member","location","name","push","url","REST_API","get","saveItem","trim","saveDepartment","console","log","hiddenEditDepartment","titlePopUpNotificationDepartment","childPopUpNotificationDepartment","addNewDepartment","body","post","put","deleteDepartmentById","delete","isShowEditDepartment","showEditDepartment","getMainAttributes","changeSort","newSort","ɵfac","DepartmentPageService_Factory","t","ɵɵinject","HttpClient","NotificationService","ɵprov","ɵɵdefineInjectable","token","factory","providedIn"],"mappings":"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","sourcesContent":["import { environment } from './../../../../environments/environment.prod';\r\nimport { Department } from 'src/app/model/department';\r\nimport * as i0 from \"@angular/core\";\r\nimport * as i1 from \"@angular/common/http\";\r\nimport * as i2 from \"./../../notification/notification.service\";\r\nexport class DepartmentPageService {\r\n    constructor(httpClient, notificationService) {\r\n        this.httpClient = httpClient;\r\n        this.notificationService = notificationService;\r\n        this.isEditDepartment = false;\r\n        this.inputSearch = \"\";\r\n        this.sortString = \"ASC\";\r\n        this.mainAttribute = \"Name\";\r\n        this.mainAttributes = [\r\n            \"Name\",\r\n        ];\r\n        this.locations = [\r\n            \"HOCHIMINH\",\r\n            \"DANANG\",\r\n            \"CANTHO\",\r\n        ];\r\n        this.isLoadData = false;\r\n        this.isOutOfData = false;\r\n        this.departments = [];\r\n        this.editName = \"\";\r\n        this.editLocation = \"\";\r\n        this.editId = 0;\r\n        this.idDepartmentNeedRemove = 0;\r\n        this.isShowPopupRequest = false;\r\n        this.isShowNotification = false;\r\n        this.isProcessRemove = false;\r\n    }\r\n    loadData(event) {\r\n        this.isOutOfData = false;\r\n        this.departments = [];\r\n        this.getListDepartment(0, 25, this.inputSearch, this.mainAttribute == \"Name\" ? \"name\" : \"location\", this.getSortString() == \"ASC\" ? \"asc\" : \"desc\", event);\r\n    }\r\n    getListDepartment(min, max, search, mainAttribute, sort, event) {\r\n        this.isLoadData = true;\r\n        document.getElementById(\"content-list\").scrollTop = 99999999;\r\n        setTimeout(() => {\r\n            this.getListDepartmentFromAPI(min, max, search, mainAttribute, sort).subscribe(async (data) => {\r\n                if (event == 1) {\r\n                    this.departments = [];\r\n                }\r\n                for (let i = 0; i < data.data.length; i++) {\r\n                    let department = new Department();\r\n                    department.id = data.data[i].id;\r\n                    await this.getEmployeeByIdDepartment(department.id).subscribe(dataGetEmployee => {\r\n                        if (dataGetEmployee.message == 'Not Found Departmant') {\r\n                            department.member = 0;\r\n                        }\r\n                        else {\r\n                            department.member = data.data.length;\r\n                        }\r\n                    });\r\n                    department.location = data.data[i].location;\r\n                    department.name = data.data[i].name;\r\n                    this.departments.push(department);\r\n                }\r\n                if (data.data.length < max || data.data.length == 0) {\r\n                    this.isOutOfData = true;\r\n                }\r\n                this.isLoadData = false;\r\n            });\r\n        }, 1000);\r\n    }\r\n    getListDepartmentFromAPI(min, max, search, mainAttribute, sort) {\r\n        const url = `${environment.REST_API}department/part?min=${min}&max=${max}&sort=${sort}&search=${search}&mainAttribute=${mainAttribute}`;\r\n        return this.httpClient.get(url);\r\n    }\r\n    getEmployeeByIdDepartment(id) {\r\n        const url = `${environment.REST_API}employee/department/${id}`;\r\n        return this.httpClient.get(url);\r\n    }\r\n    saveItem() {\r\n        if (this.editName.trim().length > 0) {\r\n            this.saveDepartment().subscribe(data => {\r\n                console.log(data);\r\n                this.hiddenEditDepartment();\r\n                this.loadData(0);\r\n                this.isShowPopupRequest = false;\r\n                this.isShowNotification = true;\r\n                this.notificationService.titlePopUpNotificationDepartment = \"Success\";\r\n                this.notificationService.childPopUpNotificationDepartment = `You have successfully updated the department #${this.editId}`;\r\n            });\r\n        }\r\n    }\r\n    addNewDepartment(body) {\r\n        const url = `${environment.REST_API}department`;\r\n        return this.httpClient.post(url, body);\r\n    }\r\n    saveDepartment() {\r\n        const url = `${environment.REST_API}department`;\r\n        let body = {\r\n            id: this.editId,\r\n            name: this.editName,\r\n            location: this.editLocation\r\n        };\r\n        return this.httpClient.put(url, body);\r\n    }\r\n    deleteDepartmentById(id) {\r\n        const url = `${environment.REST_API}department/${id}`;\r\n        return this.httpClient.delete(url);\r\n    }\r\n    isShowEditDepartment() {\r\n        return this.isEditDepartment;\r\n    }\r\n    showEditDepartment() {\r\n        this.isEditDepartment = true;\r\n    }\r\n    hiddenEditDepartment() {\r\n        this.isEditDepartment = false;\r\n    }\r\n    getMainAttributes() {\r\n        return this.mainAttributes;\r\n    }\r\n    getSortString() {\r\n        return this.sortString;\r\n    }\r\n    changeSort(newSort) {\r\n        this.sortString = newSort;\r\n    }\r\n}\r\nDepartmentPageService.ɵfac = function DepartmentPageService_Factory(t) { return new (t || DepartmentPageService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.NotificationService)); };\r\nDepartmentPageService.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: DepartmentPageService, factory: DepartmentPageService.ɵfac, providedIn: 'root' });\r\n"]},"metadata":{},"sourceType":"module"}